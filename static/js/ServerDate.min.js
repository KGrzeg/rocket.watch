"use strict";Date.now||(Date.now=function(){return(new Date).getTime()});var ServerDate=function(serverNow){var scriptLoadTime=Date.now(),URL="https://rocket.watch/js/ServerDate.min.js",synchronizationIntervalDelay,synchronizationInterval,precision,offset,target=null,synchronizing=!1;function ServerDate(){return this?ServerDate:ServerDate.toString()}function Offset(value,precision){this.value=value,this.precision=precision}function setTarget(newTarget){var message="Set target to "+String(newTarget),delta;target&&(message+=" ("+(newTarget>target?"+":"-")+" "+Math.abs(newTarget-target)+" ms)"),target=newTarget,log(message+"."),(delta=Math.abs(target-offset))>ServerDate.amortizationThreshold&&(log("Difference between target and offset too high ("+delta+" ms); skipping amortization."),offset=target)}function synchronize(){var iteration=1,requestTime,responseTime,best;function requestSample(){var request=new XMLHttpRequest,concatenationChar;concatenationChar=URL.indexOf("?")>-1?"&":"?",request.open("HEAD",URL+concatenationChar+"noCache="+Date.now()+parseInt(1e6*Math.random())),request.onreadystatechange=function(){this.readyState==this.HEADERS_RECEIVED&&200==this.status&&(responseTime=Date.now())},request.onload=function(){if(200==this.status)try{processSample(new Date(this.getResponseHeader("Date")).getTime())}catch(exception){log("Unable to read the server's response.")}},requestTime=Date.now(),request.send()}function processSample(serverNow){var precision=(responseTime-requestTime)/2,sample=new Offset(serverNow+precision-responseTime,precision);log("sample: "+iteration+", offset: "+String(sample)),(1==iteration||precision<=best.precision)&&(best=sample),iteration<10?(iteration++,requestSample()):(setTarget(best),synchronizing=!1)}synchronizing||(synchronizing=!0,setTimeout(function(){synchronizing=!1},1e4),requestSample())}function log(message){console&&console.log&&console.log("[ServerDate] "+message)}return ServerDate.parse=Date.parse,ServerDate.UTC=Date.UTC,ServerDate.now=function(){return Date.now()+offset},["toString","toDateString","toTimeString","toLocaleString","toLocaleDateString","toLocaleTimeString","valueOf","getTime","getFullYear","getUTCFullYear","getMonth","getUTCMonth","getDate","getUTCDate","getDay","getUTCDay","getHours","getUTCHours","getMinutes","getUTCMinutes","getSeconds","getUTCSeconds","getMilliseconds","getUTCMilliseconds","getTimezoneOffset","toUTCString","toISOString","toJSON"].forEach(function(method){ServerDate[method]=function(){return new Date(ServerDate.now())[method]()}}),ServerDate.getPrecision=function(){if(void 0!==target.precision)return target.precision+Math.abs(target-offset)},ServerDate.amortizationRate=25,ServerDate.amortizationThreshold=2e3,Object.defineProperty(ServerDate,"synchronizationIntervalDelay",{get:function(){return synchronizationIntervalDelay},set:function(value){synchronizationIntervalDelay=value,clearInterval(synchronizationInterval),synchronizationInterval=setInterval(synchronize,ServerDate.synchronizationIntervalDelay),log("Set synchronizationIntervalDelay to "+value+" ms.")}}),ServerDate.synchronizationIntervalDelay=6e5,Offset.prototype.valueOf=function(){return this.value},Offset.prototype.toString=function(){return this.value+(void 0!==this.precision?" +/- "+this.precision:"")+" ms"},offset=serverNow-scriptLoadTime,"undefined"!=typeof performance&&(precision=(scriptLoadTime-performance.timing.domLoading)/2,offset+=precision),setTarget(new Offset(offset,precision)),setInterval(function(){var delta=Math.max(-ServerDate.amortizationRate,Math.min(ServerDate.amortizationRate,target-offset));offset+=delta,delta&&log("Offset adjusted by "+delta+" ms to "+offset+" ms (target: "+target.value+" ms).")},1e3),window.addEventListener("pageshow",synchronize),synchronize(),ServerDate}(Date.now());